import{S as Y,i as q,s as K,K as C,e as I,t as x,c as j,a as T,g as E,d as y,b as k,f as M,D as v,h as W,k as S,j as z,n as D,m as G,o as H,x as A,u as L,U as J,v as Q,F as O,E as R,w as Z,V as $,W as ee,X as U,r as te,T as se}from"../chunks/vendor-1659fb7c.js";import{I as re,s as B,a as oe}from"../chunks/ItemSummary-b9e02421.js";const le=!0;function F(n,e,r){const i=n.slice();return i[16]=e[r],i[18]=r,i}function N(n){let e,r;return{c(){e=I("div"),r=x(n[0]),this.h()},l(i){e=j(i,"DIV",{class:!0});var s=T(e);r=E(s,n[0]),s.forEach(y),this.h()},h(){k(e,"class","font-bold text-2xl text-red-800")},m(i,s){M(i,e,s),v(e,r)},p(i,s){s&1&&W(r,i[0])},d(i){i&&y(e)}}}function P(n){let e,r,i=n[18]+1+"",s,u,d,h,g,_,p,w;return h=new re({props:{item:n[16],showText:!1}}),{c(){e=I("div"),r=I("span"),s=x(i),u=x("."),d=S(),z(h.$$.fragment),this.h()},l(l){e=j(l,"DIV",{id:!0,class:!0});var f=T(e);r=j(f,"SPAN",{class:!0});var o=T(r);s=E(o,i),u=E(o,"."),o.forEach(y),d=D(f),G(h.$$.fragment,f),f.forEach(y),this.h()},h(){k(r,"class","min-w-2 text-xl text-gray-400 text-right"),k(e,"id",g=""+(n[16].id+"_scroll")),k(e,"class","flex space-x-2 items-baseline mb-2")},m(l,f){M(l,e,f),v(e,r),v(r,s),v(r,u),v(e,d),H(h,e,null),w=!0},p(l,f){const o={};f&8&&(o.item=l[16]),h.$set(o),(!w||f&8&&g!==(g=""+(l[16].id+"_scroll")))&&k(e,"id",g)},i(l){w||(A(h.$$.fragment,l),C(()=>{p&&p.end(1),_=ee(e,U,{x:250,duration:250}),_.start()}),w=!0)},o(l){L(h.$$.fragment,l),_&&_.invalidate(),p=J(e,U,{x:-250,duration:250}),w=!1},d(l){l&&y(e),Q(h),l&&p&&p.end()}}}function X(n){let e,r,i,s;return{c(){e=I("button"),r=x("Load more..."),this.h()},l(u){e=j(u,"BUTTON",{class:!0});var d=T(e);r=E(d,"Load more..."),d.forEach(y),this.h()},h(){k(e,"class","pt-2 pb-4 text-left text-gray-500")},m(u,d){M(u,e,d),v(e,r),i||(s=O(e,"click",n[8]),i=!0)},p:R,d(u){u&&y(e),i=!1,s()}}}function ae(n){let e=!1,r=()=>{e=!1},i,s,u,d,h,g,_,p,w;C(n[7]);let l=n[0]&&N(n),f=n[3],o=[];for(let a=0;a<f.length;a+=1)o[a]=P(F(n,f,a));const V=a=>L(o[a],1,1,()=>{o[a]=null});let m=n[2]&&X(n);return{c(){s=I("div"),l&&l.c(),u=S();for(let a=0;a<o.length;a+=1)o[a].c();d=S(),h=I("div"),g=S(),m&&m.c(),this.h()},l(a){s=j(a,"DIV",{class:!0});var c=T(s);l&&l.l(c),u=D(c);for(let t=0;t<o.length;t+=1)o[t].l(c);d=D(c),h=j(c,"DIV",{class:!0}),T(h).forEach(y),g=D(c),m&&m.l(c),c.forEach(y),this.h()},h(){k(h,"class","flex-grow"),k(s,"class","flex flex-col overflow-x-hidden")},m(a,c){M(a,s,c),l&&l.m(s,null),v(s,u);for(let t=0;t<o.length;t+=1)o[t].m(s,null);v(s,d),v(s,h),v(s,g),m&&m.m(s,null),_=!0,p||(w=O(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(r,100),n[7]()}),p=!0)},p(a,[c]){if(c&2&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,a[1]),i=setTimeout(r,100)),a[0]?l?l.p(a,c):(l=N(a),l.c(),l.m(s,u)):l&&(l.d(1),l=null),c&8){f=a[3];let t;for(t=0;t<f.length;t+=1){const b=F(a,f,t);o[t]?(o[t].p(b,c),A(o[t],1)):(o[t]=P(b),o[t].c(),A(o[t],1),o[t].m(s,d))}for(te(),t=f.length;t<o.length;t+=1)V(t);Z()}a[2]?m?m.p(a,c):(m=X(a),m.c(),m.m(s,null)):m&&(m.d(1),m=null)},i(a){if(!_){for(let c=0;c<f.length;c+=1)A(o[c]);_=!0}},o(a){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)L(o[c]);_=!1},d(a){a&&y(s),l&&l.d(),$(o,a),m&&m.d(),p=!1,w()}}}async function ue({page:n,fetch:e}){const r=ne(n.params.category),i="https://hacker-news.firebaseio.com/v0/"+r;let s=await e(i);return s.ok?{props:{storyIds:await s.json(),category:r}}:{props:{errorMessage:"Failed to retrieve data from API"}}}function ne(n){switch(n){case"top":return"topstories.json";case"newest":return"newstories.json";case"ask":return"askstories.json";case"show":return"showstories.json";case"jobs":return"jobstories.json"}}function ie(n,e,r){let{category:i}=e,{errorMessage:s=void 0}=e,{storyIds:u}=e,d=!1,h=0,g=30,_=new Array,p,w=!1,l;async function f(){w=!0,r(2,d=!1);const t=await oe(u.slice(h,g));for(let b=0;b<t.length;b++)await B(25),r(3,_=[..._,t[b]]);w=!1,r(2,d=!0)}async function o(t){w||(h=g,g+=t,B(100),f())}async function V(t){if(l===t){console.log("in the same category");return}t=t,h=0,g=30,r(2,d=!1),r(3,_=new Array),await B(100),await se(),await B(100),f()}function m(t){if(!w&&le&&_.length>0){const b=document.getElementById(_[_.length-16].id+"_scroll");t>b.offsetTop&&o(3)}}function a(){r(1,p=window.pageYOffset)}const c=()=>o(10);return n.$$set=t=>{"category"in t&&r(5,i=t.category),"errorMessage"in t&&r(0,s=t.errorMessage),"storyIds"in t&&r(6,u=t.storyIds)},n.$$.update=()=>{n.$$.dirty&32&&V(i),n.$$.dirty&2&&m(p)},[s,p,d,_,o,i,u,a,c]}class de extends Y{constructor(e){super();q(this,e,ie,ae,K,{category:5,errorMessage:0,storyIds:6})}}export{de as default,ue as load};
