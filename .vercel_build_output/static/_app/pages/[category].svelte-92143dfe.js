import{S as q,i as K,s as R,K as O,e as k,t as T,c as I,a as j,g as x,d as y,b,f as E,D as v,h as W,k as M,j as X,n as S,m as z,o as G,x as D,u as V,R as H,v as J,F as U,E as Q,w as Z,T as $,U as ee,V as C,r as te,W as se}from"../chunks/vendor-5b516324.js";import{I as re,s as A,a as oe}from"../chunks/ItemSummary-08328a07.js";const le=!0;function F(n,e,r){const i=n.slice();return i[14]=e[r],i[16]=r,i}function N(n){let e,r;return{c(){e=k("div"),r=T(n[0]),this.h()},l(i){e=I(i,"DIV",{class:!0});var s=j(e);r=x(s,n[0]),s.forEach(y),this.h()},h(){b(e,"class","font-bold text-2xl text-red-800")},m(i,s){E(i,e,s),v(e,r)},p(i,s){s&1&&W(r,i[0])},d(i){i&&y(e)}}}function P(n){let e,r,i=n[16]+1+"",s,u,d,h,g,_,p,w;return h=new re({props:{item:n[14],showText:!1}}),{c(){e=k("div"),r=k("span"),s=T(i),u=T("."),d=M(),X(h.$$.fragment),this.h()},l(o){e=I(o,"DIV",{id:!0,class:!0});var f=j(e);r=I(f,"SPAN",{class:!0});var l=j(r);s=x(l,i),u=x(l,"."),l.forEach(y),d=S(f),z(h.$$.fragment,f),f.forEach(y),this.h()},h(){b(r,"class","min-w-2 text-xl text-gray-400 text-right"),b(e,"id",g=""+(n[14].id+"_scroll")),b(e,"class","flex space-x-2 items-baseline mb-2")},m(o,f){E(o,e,f),v(e,r),v(r,s),v(r,u),v(e,d),G(h,e,null),w=!0},p(o,f){const l={};f&8&&(l.item=o[14]),h.$set(l),(!w||f&8&&g!==(g=""+(o[14].id+"_scroll")))&&b(e,"id",g)},i(o){w||(D(h.$$.fragment,o),O(()=>{p&&p.end(1),_=ee(e,C,{x:250,duration:250}),_.start()}),w=!0)},o(o){V(h.$$.fragment,o),_&&_.invalidate(),p=H(e,C,{x:-250,duration:250}),w=!1},d(o){o&&y(e),J(h),o&&p&&p.end()}}}function Y(n){let e,r,i,s;return{c(){e=k("button"),r=T("Load more..."),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var d=j(e);r=x(d,"Load more..."),d.forEach(y),this.h()},h(){b(e,"class","pt-2 pb-4 text-left text-gray-500")},m(u,d){E(u,e,d),v(e,r),i||(s=U(e,"click",n[4]),i=!0)},p:Q,d(u){u&&y(e),i=!1,s()}}}function ae(n){let e=!1,r=()=>{e=!1},i,s,u,d,h,g,_,p,w;O(n[7]);let o=n[0]&&N(n),f=n[3],l=[];for(let t=0;t<f.length;t+=1)l[t]=P(F(n,f,t));const B=t=>V(l[t],1,1,()=>{l[t]=null});let m=n[2]&&Y(n);return{c(){s=k("div"),o&&o.c(),u=M();for(let t=0;t<l.length;t+=1)l[t].c();d=M(),h=k("div"),g=M(),m&&m.c(),this.h()},l(t){s=I(t,"DIV",{class:!0});var a=j(s);o&&o.l(a),u=S(a);for(let c=0;c<l.length;c+=1)l[c].l(a);d=S(a),h=I(a,"DIV",{class:!0}),j(h).forEach(y),g=S(a),m&&m.l(a),a.forEach(y),this.h()},h(){b(h,"class","flex-grow"),b(s,"class","flex flex-col overflow-x-hidden")},m(t,a){E(t,s,a),o&&o.m(s,null),v(s,u);for(let c=0;c<l.length;c+=1)l[c].m(s,null);v(s,d),v(s,h),v(s,g),m&&m.m(s,null),_=!0,p||(w=U(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(r,100),n[7]()}),p=!0)},p(t,[a]){if(a&2&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,t[1]),i=setTimeout(r,100)),t[0]?o?o.p(t,a):(o=N(t),o.c(),o.m(s,u)):o&&(o.d(1),o=null),a&8){f=t[3];let c;for(c=0;c<f.length;c+=1){const L=F(t,f,c);l[c]?(l[c].p(L,a),D(l[c],1)):(l[c]=P(L),l[c].c(),D(l[c],1),l[c].m(s,d))}for(te(),c=f.length;c<l.length;c+=1)B(c);Z()}t[2]?m?m.p(t,a):(m=Y(t),m.c(),m.m(s,null)):m&&(m.d(1),m=null)},i(t){if(!_){for(let a=0;a<f.length;a+=1)D(l[a]);_=!0}},o(t){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)V(l[a]);_=!1},d(t){t&&y(s),o&&o.d(),$(l,t),m&&m.d(),p=!1,w()}}}async function ue({page:n,fetch:e}){const r=ne(n.params.category),i="https://hacker-news.firebaseio.com/v0/"+r;let s=await e(i);return s.ok?{props:{storyIds:await s.json(),category:r}}:{props:{errorMessage:"Failed to retrieve data from API"}}}function ne(n){switch(n){case"top":return"topstories.json";case"newest":return"newstories.json";case"ask":return"askstories.json";case"show":return"showstories.json";case"jobs":return"jobstories.json"}}function ie(n,e,r){let{category:i}=e,{errorMessage:s=void 0}=e,{storyIds:u}=e,d=!1,h=0,g=30,_=new Array,p,w=!1;async function o(){w=!0,r(2,d=!1);const t=await oe(u.slice(h,g));for(let a=0;a<t.length;a++)await A(25),r(3,_=[..._,t[a]]);w=!1,r(2,d=!0)}async function f(){w||(h=g,g+=1,A(100),o())}async function l(t){h=0,g=30,r(2,d=!1),r(3,_=new Array),await A(100),await se(),await A(100),o()}function B(t){if(!w&&le&&_.length>0){const a=document.getElementById(_[_.length-16].id+"_scroll");t>a.offsetTop&&f()}}function m(){r(1,p=window.pageYOffset)}return n.$$set=t=>{"category"in t&&r(5,i=t.category),"errorMessage"in t&&r(0,s=t.errorMessage),"storyIds"in t&&r(6,u=t.storyIds)},n.$$.update=()=>{n.$$.dirty&32&&l(),n.$$.dirty&2&&B(p)},[s,p,d,_,f,i,u,m]}class de extends q{constructor(e){super();K(this,e,ie,ae,R,{category:5,errorMessage:0,storyIds:6})}}export{de as default,ue as load};
